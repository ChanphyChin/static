<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title>time-machine</title>
  <link rel="stylesheet"  type="text/css"  href="./css/upload.css" >
</head>
<body>
  <div class="upload-main">
    <div class="btn upload">
    	<input type="file" id="input">
		<span>选择音乐</span>
    </div>
    <div class="btn" id="cancel">
		<span>取消</span>
    </div>
  </div>
</body>
<script type="text/javascript">
  var userAgent = navigator.userAgent;
  if (userAgent.indexOf('AlipayClient') > -1) {
    // 支付宝小程序的 JS-SDK 防止 404 需要动态加载，如果不需要兼容支付宝小程序，则无需引用此 JS 文件。
    document.writeln('<script src="https://appx/web-view.min.js"' + '>' + '<' + '/' + 'script>');
  } else if (/QQ/i.test(userAgent) && /miniProgram/i.test(userAgent)) {
    // QQ 小程序
    document.write(
      '<script type="text/javascript" src="https://qqq.gtimg.cn/miniprogram/webview_jssdk/qqjssdk-1.0.0.js"><\/script>'
    );
  } else if (/miniProgram/i.test(userAgent) && /micromessenger/i.test(userAgent)) {
    // 微信小程序 JS-SDK 如果不需要兼容微信小程序，则无需引用此 JS 文件。
    document.write('<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"><\/script>');
  } else if (/toutiaomicroapp/i.test(userAgent)) {
    // 头条小程序 JS-SDK 如果不需要兼容头条小程序，则无需引用此 JS 文件。
    document.write(
      '<script type="text/javascript" src="https://s3.pstatp.com/toutiao/tmajssdk/jssdk-1.0.1.js"><\/script>');
  } else if (/swan/i.test(userAgent)) {
    // 百度小程序 JS-SDK 如果不需要兼容百度小程序，则无需引用此 JS 文件。
    document.write(
      '<script type="text/javascript" src="https://b.bdstatic.com/searchbox/icms/searchbox/js/swan-2.0.18.js"><\/script>'
    );
  } else if (/quickapp/i.test(userAgent)) {
    // quickapp
    document.write('<script type="text/javascript" src="https://quickapp/jssdk.webview.min.js"><\/script>');
  }
  if (!/toutiaomicroapp/i.test(userAgent)) {
    document.querySelector('.post-message-section').style.visibility = 'visible';
  }
</script>
<script src="./js/uni-sdk.js"></script>
<script>
	document.addEventListener('UniAppJSBridgeReady', function() {
		document.querySelector('#cancel').onclick = function () {
      uni.getEnv(function(res) {
          alert('当前环境：' + JSON.stringify(res));
      });
      window.postMessage({
					data: {
						cancel: true
					}
      });
      uni.navigateBack();
			// var userAgent = navigator.userAgent;
			// if(/miniProgram/i.test(userAgent) && /micromessenger/i.test(userAgent)) {
      //   window.postMessage({
			// 		data: {
			// 			cancel: true
			// 		}
			// 	});
      //   uni.navigateBack();
			// } else {
      //   uni.postMessage({
      //     data: {
      //       cancel: true
      //     }
      //   });
      // }
		}
		document.querySelector('#input').onchange = function(e) {
			console.log(e);
		}
	})
</script>
</html>